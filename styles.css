:root{
  --bg:#1e1e1e;
  --panel:#2a2a2a;
  --panel2:#232323;
  --text:#ffffff;
  --muted:#b9b9b9;
  --accent:#ffcc00;
  --good:#38d46a;
  --bad:#ff4b4b;
  --border:#444;
  --shadow: rgba(0,0,0,0.55);
}

*{ box-sizing:border-box; }
body{
  margin:0;
  background: radial-gradient(1200px 800px at 50% 0%, #2a2a2a 0%, var(--bg) 60%);
  color:var(--text);
  font-family: Arial, sans-serif;
  display:flex;
  min-height:100dvh;
  align-items:center;
  justify-content:center;
  padding:16px;
  overflow-x:hidden;
  overflow-y:auto;
  -webkit-text-size-adjust: 100%;
}

/* On small screens, don’t vertically “center-crop” the app — let it start at top and scroll */
@media (max-width: 520px){
  body{ align-items:flex-start; padding:12px; }
}

.app{
  width: min(980px, calc(100vw - 32px));
  max-width: 100%;
  max-height: calc(100dvh - 32px);
  overflow: auto;
  -webkit-overflow-scrolling: touch;
  display:grid;
  grid-template-rows:auto auto auto 1fr auto;
  gap:14px;
  padding:16px;
  border:4px solid var(--border);
  border-radius:18px;
  background: linear-gradient(180deg, var(--panel) 0%, var(--panel2) 100%);
  box-shadow: 0 14px 35px var(--shadow);
  position:relative;
}

@media (max-width: 520px){
  .app{ width: calc(100vw - 24px); max-height: calc(100dvh - 24px); padding:12px; gap:12px; }
}

.topRow{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  flex-wrap:wrap;
}

.title{
  font-size: clamp(18px, 2.2vw, 26px);
  font-weight:800;
  letter-spacing:0.4px;
}

.pillRow{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  align-items:center;
  justify-content:flex-end;
}

.pill{
  display:flex;
  align-items:center;
  gap:8px;
  padding:10px 12px;
  border:2px solid var(--border);
  border-radius:999px;
  background:#141414;
  font-size: clamp(12px, 1.6vw, 15px);
  color:var(--muted);
  user-select:none;
  max-width: 100%;
  white-space:normal;
  overflow:hidden;
  text-overflow:ellipsis;
}
.pill strong{ color:var(--text); font-weight:800; }

.questionBox{
  border:3px solid var(--border);
  border-radius:14px;
  padding:14px 14px;
  background:#101010;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  position:relative;
  overflow:hidden;
}

.question{
  font-size: clamp(18px, 3.2vw, 34px);
  font-weight:900;
  letter-spacing:0.2px;
}

.timer{
  font-size: clamp(16px, 2.6vw, 30px);
  font-weight:900;
  color:var(--accent);
  min-width: 4ch;
  text-align:right;
}

.msg{
  margin-top:-6px;
  font-size: clamp(12px, 1.7vw, 15px);
  color: var(--muted);
  display:flex;
  justify-content:space-between;
  gap:10px;
  flex-wrap:wrap;
}

/* Stair progress */
.progressWrap{
  border:2px solid var(--border);
  border-radius:14px;
  background:#101010;
  padding:10px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
}
.progressLeft{
  display:flex;
  align-items:center;
  gap:12px;
  min-width: 0;
}
.progressTitle{
  font-weight:900;
  color:var(--text);
  font-size:14px;
  white-space:nowrap;
}
.progressHint{
  font-size:12px;
  color:var(--muted);
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
.stairSvg{
  width: min(260px, 42vw);
  height: 90px;
  display:block;
}

/* Current step highlight */
#stepHighlight{ transition: d 180ms ease; }
.stepPulse{ animation: stepPulse 720ms ease-in-out infinite; }
@keyframes stepPulse{
  0%{ opacity:0.55; }
  50%{ opacity:1; }
  100%{ opacity:0.55; }
}

.answers,
#answers{ 
  display:grid;
  grid-template-columns: repeat(7, minmax(0, 1fr));
  gap:10px;
}
@media (max-width: 760px){ .answers, #answers{ grid-template-columns: repeat(3, minmax(0, 1fr)); } }
@media (max-width: 420px){ .answers, #answers{ grid-template-columns: repeat(2, minmax(0, 1fr)); } }
@media (max-width: 760px){ .answers{ grid-template-columns: repeat(3, minmax(0, 1fr)); } }
@media (max-width: 420px){ .answers{ grid-template-columns: repeat(2, minmax(0, 1fr)); } }

/* Buttons */
button.answer,
.answer{
  border:3px solid var(--border);
  background:#0f0f0f;
  color:var(--text);
  border-radius:14px;
  padding:14px 10px;
  font-size: clamp(14px, 2.2vw, 20px);
  font-weight:900;
  cursor:pointer;
}

/* keep original selector for compatibility */
button.answer{
  border:3px solid var(--border);
  background:#0f0f0f;
  color:var(--text);
  border-radius:14px;
  padding:14px 10px;
  font-size: clamp(14px, 2.2vw, 20px);
  font-weight:900;
  cursor:pointer;
}

.bottomRow{
  display:flex;
  justify-content:space-between;
  gap:10px;
  flex-wrap:wrap;
  align-items:center;
}
.controls,
#controls{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}
.btn,
button.btn{
  padding:10px 12px;
  border-radius:12px;
  border:2px solid var(--border);
  background:#0f0f0f;
  color:#fff;
  font-weight:900;
}
.status{ font-size:14px; color:var(--muted); }

/* ==============================
   LANDSCAPE / HORIZONTAL MODE
   Hide non‑essential UI
   ============================== */
@media (orientation: landscape) and (max-height: 520px){
  .topRow,
  .pillRow,
  .progressWrap,
  .bottomRow,
  .controls,
  .status{
    display:none !important;
  }

  .app{
    grid-template-rows: auto auto 1fr;
    padding:12px;
    gap:10px;
  }

  .question{
    font-size: clamp(18px, 4vw, 32px);
  }

  .answers{
    grid-template-columns: repeat(4, minmax(0, 1fr));
    gap:8px;
  }
}

.timeLow{ color: #ff8f1f !important; }
.timeOut{ color: var(--bad) !important; }

/* ==============================
   Effects + overlays (required by JS)
   ============================== */

/* App shake on wrong */
.shake{ animation: appShake 260ms ease-in-out; }
@keyframes appShake{
  0%{ transform: translateX(0); }
  20%{ transform: translateX(-8px); }
  40%{ transform: translateX(8px); }
  60%{ transform: translateX(-6px); }
  80%{ transform: translateX(6px); }
  100%{ transform: translateX(0); }
}

/* Stair SVG shake + tumble */
.fallShake{ animation: fallShake 320ms ease-in-out; }
@keyframes fallShake{
  0%{ transform: translateX(0); }
  20%{ transform: translateX(-10px); }
  40%{ transform: translateX(10px); }
  60%{ transform: translateX(-8px); }
  80%{ transform: translateX(8px); }
  100%{ transform: translateX(0); }
}

.tumble{ animation: tumble 420ms ease-in-out; transform-origin: center; }
@keyframes tumble{
  0%{ transform: translate(var(--tx,0), var(--ty,0)) rotate(0deg); }
  50%{ transform: translate(var(--tx,0), var(--ty,0)) rotate(-14deg); }
  100%{ transform: translate(var(--tx,0), var(--ty,0)) rotate(0deg); }
}

/* Answer button states */
button.answer:disabled{ opacity:0.55; cursor:not-allowed; }
button.answer:hover{ filter: brightness(1.08); }
button.answer:active{ transform: translateY(1px); }

/* Overlays (right/wrong)
   NOTE: JS toggles .show on #overlayBad/#overlayGood.
   Some builds used class="overlay"; others only used the IDs.
   Support BOTH. */
.overlay,
#overlayBad,
#overlayGood{
  position:absolute;
  inset:0;
  display:none;
  align-items:center;
  justify-content:center;
  z-index:50;
  background: rgba(0,0,0,.55);
  backdrop-filter: blur(6px);
}
.overlay.show,
#overlayBad.show,
#overlayGood.show{ display:flex; }

.fxCard{
  width:min(560px, calc(100% - 24px));
  border:2px solid rgba(255,255,255,.16);
  background: rgba(12,12,12,.92);
  border-radius:18px;
  padding:18px 16px;
  box-shadow: 0 24px 70px rgba(0,0,0,.65);
  text-align:center;
  position:relative;
}

/* If the HTML doesn’t include a .face element, render it via CSS so the green/red face always appears */
#overlayGood .fxCard,
#overlayBad .fxCard{ padding-top: 128px; }

#overlayGood .fxCard::before,
#overlayBad  .fxCard::before{
  content:"";
  position:absolute;
  top:18px;
  left:50%;
  transform:translateX(-50%);
  width:92px;
  height:92px;
  border-radius:50%;
  border:3px solid rgba(255,255,255,.18);
  /* eyes drawn with radial gradients */
  background:
    radial-gradient(circle at 34% 38%, rgba(255,255,255,.95) 0 5px, transparent 6px),
    radial-gradient(circle at 66% 38%, rgba(255,255,255,.95) 0 5px, transparent 6px),
    radial-gradient(circle at 50% 50%, transparent 0 999px);
}

#overlayGood .fxCard::before{
  background:
    radial-gradient(circle at 34% 38%, rgba(255,255,255,.95) 0 5px, transparent 6px),
    radial-gradient(circle at 66% 38%, rgba(255,255,255,.95) 0 5px, transparent 6px),
    radial-gradient(circle at 50% 50%, rgba(56,212,106,.26) 0 999px);
  border-color: rgba(56,212,106,.60);
}

#overlayBad .fxCard::before{
  background:
    radial-gradient(circle at 34% 38%, rgba(255,255,255,.95) 0 5px, transparent 6px),
    radial-gradient(circle at 66% 38%, rgba(255,255,255,.95) 0 5px, transparent 6px),
    radial-gradient(circle at 50% 50%, rgba(255,75,75,.20) 0 999px);
  border-color: rgba(255,75,75,.60);
}

/* Mouth */
#overlayGood .fxCard::after,
#overlayBad  .fxCard::after{
  content:"";
.fxBig{
  font-size: clamp(24px, 6vw, 48px);
  font-weight: 1000;
  letter-spacing: .3px;
  margin-bottom: 6px;
}
.fxSmall{
  font-size: clamp(14px, 2.4vw, 18px);
  color: var(--muted);
  font-weight: 800;
}

/* Simple face icons (green/red) */
.face{
  width: 86px;
  height: 86px;
  border-radius: 50%;
  margin: 0 auto 12px;
  border: 3px solid rgba(255,255,255,.2);
  position: relative;
}
.face.good{ background: rgba(56,212,106,.22); border-color: rgba(56,212,106,.55); }
.face.bad{ background: rgba(255,75,75,.18); border-color: rgba(255,75,75,.55); }
.face:before,.face:after{ content:""; position:absolute; top:28px; width:10px; height:10px; border-radius:50%; background:#fff; opacity:.95; }
.face:before{ left:26px; }
.face:after{ right:26px; }
.face .mouth{ position:absolute; left:50%; top:52px; width:38px; height:18px; border:4px solid rgba(255,255,255,.9); border-color: rgba(255,255,255,.9) transparent transparent transparent; border-radius: 50%; transform: translateX(-50%); }
.face.bad .mouth{ border-color: transparent transparent rgba(255,255,255,.9) transparent; top:56px; }

/* End modal overlay
   NOTE: JS toggles .show on #overlayEnd.
   Support BOTH .endBack and #overlayEnd. */
.endBack,
#overlayEnd{
  position:fixed;
  inset:0;
  display:none;
  align-items:center;
  justify-content:center;
  background: rgba(0,0,0,.60);
  z-index:9998;
  padding:14px;
}
.endBack.show,
#overlayEnd.show{ display:flex; }
.endModal{
  width:min(720px, 100%);
  max-height: calc(100dvh - 28px);
  overflow:auto;
  -webkit-overflow-scrolling: touch;
  background: rgba(12,12,12,.94);
  border:1px solid rgba(255,255,255,.16);
  border-radius:18px;
  box-shadow: 0 24px 70px rgba(0,0,0,.65);
  padding:16px;
}
.endModal h2{ margin:0 0 8px; font-size: clamp(20px, 4vw, 32px); }
.endModal p{ margin:0 0 10px; color: var(--muted); font-weight:700; }

/* SVG stick figure running legs (class toggled by JS) */
.running .legA{ animation: legA 260ms ease-in-out infinite; transform-origin: top center; }
.running .legB{ animation: legB 260ms ease-in-out infinite; transform-origin: top center; }
@keyframes legA{ 0%{ transform: rotate(18deg);} 50%{ transform: rotate(-18deg);} 100%{ transform: rotate(18deg);} }
@keyframes legB{ 0%{ transform: rotate(-18deg);} 50%{ transform: rotate(18deg);} 100%{ transform: rotate(-18deg);} }
